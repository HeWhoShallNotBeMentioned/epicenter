<div class="<%= set_internship_background(@rating) %>">
  <h1><%= @company.name %></h1>
</div>
<table class="table table-rating">
  <tr>
    <th>Company info:</th>
    <td>
      <%= link_to @company.website, @company.website %><br>
      <%= @company.address %><br><br>
      <%= @company.description %>
    </td>
  </tr>
  <tr>
    <th>Internship description:</th>
    <td>
      <%= @internship.description %>
    </td>
  </tr>
  <tr>
    <th>Ideal intern:</th>
    <td>
      <%= @internship.ideal_intern %>
    </td>
  </tr>
  <% if @internship.clearance_required %>
    <tr>
      <th>Clearance description</th>
      <td>
        <%= @internship.clearance_description %>
      </td>
    </tr>
  <% end %>
</table>

<% if @rating %>
  <%= form_for Rating.new do |f| %>
    <%= f.hidden_field :internship_id, value: @internship.id %>
    <%= f.label :interest, 'High', class: 'radio inline' %>
    <%= f.radio_button :interest, 1 %>
    <%= f.label :interest, 'Medium', class: 'radio inline' %>
    <%= f.radio_button :interest, 2 %>
    <%= f.label :interest, 'Low', class: 'radio inline' %>
    <%= f.radio_button :interest, 3 %>
    <% if current_student.ratings.where(internship_id: @internship.id).empty? %>
      <%= f.text_area :notes, value: nil, required: true, minlength: 10, placeholder: "Notes", class: 'large-text-area' %>
    <% else %>
      <%= f.text_area :notes, value: current_student.find_rating(@internship).notes, required: true, minlength: 10, class: 'large-text-area' %>
    <% end %>
    <%= f.submit 'Submit', class: 'btn btn-info' %>
  <% end %>
<% end %>

<% if current_admin %>
  <ul class='nav nav-pills'>
    <li class='<%= 'active' if params[:tab].nil? %>'>
      <%= link_to "Highly interested students", course_internship_path(@internship.course, @internship), class: 'unstyled-link' %>
    </li>
    <li class='<%= 'active' if params[:tab] == 'medium' %>'>
      <%= link_to "Moderately interested students", course_internship_path(@internship.course, @internship, tab: 'medium'), class: 'unstyled-link' %>
    </li>
    <li class='<%= 'active' if params[:tab] == 'low' %>'>
      <%= link_to "Not interested students", course_internship_path(@internship.course, @internship, tab: 'low'), class: 'unstyled-link' %>
    </li>
  </ul>

  <table class='table table-striped span8'>
    <tr>
      <th>Student Name</th>
      <th>Notes</th>
    </tr>
    <% if params[:tab].nil? %>
      <% Student.find_students_by_interest(@internship, '1').each do |student| %>
        <%= render 'student_row', student: student, internship: @internship %>
      <% end %>
    <% elsif params[:tab] == 'medium' %>
      <% Student.find_students_by_interest(@internship, '2').each do |student| %>
        <%= render 'student_row', student: student, internship: @internship %>
      <% end %>
    <% elsif params[:tab] == 'low' %>
      <% Student.find_students_by_interest(@internship, '3').each do |student| %>
        <%= render 'student_row', student: student, internship: @internship %>
      <% end %>
    <% end %>
  </table>
<% end %>
